name: Lint Code

on:
  push:
    paths:
      - "**/*.py"
      - ".github/actions/validate-frontmatter/**/*.ts"
  pull_request:
    paths:
      - "**/*.py"
      - ".github/actions/validate-frontmatter/**/*.ts"

jobs:
  python-lint:
    name: Lint Python Files
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install flake8
      - name: Run flake8
        run: flake8 --max-line-length=88 .

  typescript-lint:
    name: Lint TypeScript Workflow File
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Change working directory to the action
        run: cd .github/actions/validate-frontmatter
      - name: Setup pnpm
        uses: pnpm/action-setup@v4
        with:
            version: 10.8.0
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 22.14.0
          cache: 'pnpm'
          cache-dependency-path: './pnp-lock.yaml'
      - name: Install ESLint
        run: pnpm install --frozen-lockfile
      - name: Run ESLint on TS files
        run: pnpm exec eslint **/*.ts